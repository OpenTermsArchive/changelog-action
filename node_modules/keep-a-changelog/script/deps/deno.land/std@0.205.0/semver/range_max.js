"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.rangeMax = void 0;
// Copyright 2018-2023 the Deno authors. All rights reserved. MIT license.
const constants_js_1 = require("./constants.js");
const sort_js_1 = require("./sort.js");
const test_range_js_1 = require("./test_range.js");
/**
 * The maximum valid SemVer for a given range or INVALID
 * @param range The range to calculate the max for
 * @returns A valid SemVer or INVALID
 */
function rangeMax(range) {
    // For and's, you take the smallest max
    // For or's, you take the biggest max
    //[ [1 and 2] or [2 and 3] ] = [ 1 or 2 ] = 2
    return (0, sort_js_1.sort)(range.ranges.map((r) => (0, sort_js_1.sort)(r.filter((c) => (0, test_range_js_1.testRange)(c.max, range)).map((c) => c.max)).shift())).filter((v) => v).pop() ?? constants_js_1.INVALID;
}
exports.rangeMax = rangeMax;
